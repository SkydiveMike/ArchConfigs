#=======================================================================
#                              i3 config file
#=======================================================================

# put it in ~/.config/i3/ or ~/.i3/config
# Ilja Kocken (@japhir)

#=======================================================================
#                                Basics
#=======================================================================

# I use the superkey, you can also use Alt
set $mod Mod4 

# mouse modifier
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# smart dmenu
# bindsym $mod+d exec i3-dmenu-desktop 

#=======================================================================
#                          Window management
#=======================================================================

# vim keybindings
set $left  h
set $down  j
set $up    k
set $right l

# kill focused window
bindsym $mod+Shift+q kill

# change focus
bindsym $mod+$left  focus left
bindsym $mod+$down  focus down
bindsym $mod+$up    focus up
bindsym $mod+$right focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left  focus left
bindsym $mod+Down  focus down
bindsym $mod+Up    focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+$left  move left
bindsym $mod+Shift+$down  move down
bindsym $mod+Shift+$up    move up
bindsym $mod+Shift+$right move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left  move left
bindsym $mod+Shift+Down  move down
bindsym $mod+Shift+Up    move up
bindsym $mod+Shift+Right move right

# split toggle
bindsym $mod+t split toggle

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# move the currently focused window to the scratchpad
bindsym $mod+Shift+minus move scratchpad

# show next scratchpad window or hide focused scratchpad window
# cycle if there are multiple
bindsym $mod+minus scratchpad show

# make the currently focused window sticky
bindsym $mod+Shift+s sticky toggle

# resize window (you can also use the mouse)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym $left  resize shrink width  10 px or 10 ppt
        bindsym $down  resize grow   height 10 px or 10 ppt
        bindsym $up    resize shrink height 10 px or 10 ppt
        bindsym $right resize grow   width  10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left  resize shrink width  10 px or 10 ppt
        bindsym Down  resize grow   height 10 px or 10 ppt
        bindsym Up    resize shrink height 10 px or 10 ppt
        bindsym Right resize grow   width  10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"

#=======================================================================
#                              Workspaces
#=======================================================================

# workspace names
set $workspace1 "1:"
set $workspace2 "2:"
set $workspace3 "3:"
set $workspace4 "4:"
set $workspace5 "5:"
set $workspace6 "6:"
set $workspace7 "7:"
set $workspace8 "8:"
set $workspace9 "9:"
set $workspace10 "10:"

# assign workspaces to screens
workspace $workspace1 output LVDS1
workspace $workspace8 output LVDS1
workspace $workspace9 output LVDS1
workspace $workspace10 output LVDS1
workspace $workspace2 output VGA1
workspace $workspace3 output VGA1
workspace $workspace4 output VGA1

# switch to workspace
bindsym $mod+1 workspace $workspace1
bindsym $mod+2 workspace $workspace2
bindsym $mod+3 workspace $workspace3
bindsym $mod+4 workspace $workspace4
bindsym $mod+5 workspace $workspace5
bindsym $mod+6 workspace $workspace6
bindsym $mod+7 workspace $workspace7
bindsym $mod+8 workspace $workspace8
bindsym $mod+9 workspace $workspace9
bindsym $mod+0 workspace $workspace10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $workspace1
bindsym $mod+Shift+2 move container to workspace $workspace2
bindsym $mod+Shift+3 move container to workspace $workspace3
bindsym $mod+Shift+4 move container to workspace $workspace4
bindsym $mod+Shift+5 move container to workspace $workspace5
bindsym $mod+Shift+6 move container to workspace $workspace6
bindsym $mod+Shift+7 move container to workspace $workspace7
bindsym $mod+Shift+8 move container to workspace $workspace8
bindsym $mod+Shift+9 move container to workspace $workspace9
bindsym $mod+Shift+0 move container to workspace $workspace10

# switch to previous workspace by repeatedly tapping
workspace_auto_back_and_forth yes

#=======================================================================
#                       Reload/Exit/Lock
#=======================================================================

# reload the configuration file
bindsym $mod+Shift+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# exit i3 (logs you out of your X session)
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# Lock the desktop
bindsym $mod+Delete exec ~/ArchConfigs/launchi3lock.sh #&& sudo sh -c "echo mem > /sys/power/state

#=======================================================================
#                                 i3bar
#=======================================================================

# Set the font
font pango: Roboto Bold, FontAwesome 10

# Colors 
# first the main theme colors and the accent color are defined to reuse
set $light #424242
set $mid #303030
set $dark #212121

set $acc #F44336
set $wht #FFFFFF
set $blk #000000

# class                  border  backgr. text    indicator
client.focused           $light  $light  $wht    
client.focused_inactive  $mid    $mid    #c4c4c4
client.unfocused         $blk    $dark   #5e5e5e
client.urgent            $acc    $acc    $wht    
client.placeholder       $blk    $mid    $wht    

# Start i3bar to display a workspace bar 
# (plus the system information i3status finds out, if available)
# bar {
#     verbose yes
#     font    pango: Roboto Bold, FontAwesome 8
#     colors {
#         background $blk
#         statusline #b0b0b0
#         separator  #1c1c1c
#         #                   class   border  backgr    text
#         focused_workspace   $light  $light  $wht
#         active_workspace    $light  $light  #c4c4c4
#         inactive_workspace  $mid    $mid    #696969
#         urgent_workspace    $acc    $acc    $wht
#     }
#     position        top
#     status_command  i3status
# }

exec_always --no-startup-id $HOME/.config/polybar/launch.sh

# toggle the bar
# bindsym $mod+b bar mode toggle

#=======================================================================
#                      Specific program settings
#=======================================================================

### move programs to specific workspaces ###

assign [class="Mendeley Desktop"] $workspace4  
assign [class="^Chromium$" instance="solismail.uu.nl__owa"] $workspace7
assign [class="^Wfica$"] $workspace8
assign [class="^VirtualBox$" title="^Win10"] $workspace8
assign [class="R_x11"] $workspace9     # R graphics output
assign [class="^Google Play Music Desktop Player$"] $workspace10
# assign [class="Spotify"] $workspace10 # doesn't work so workaround
# for_window [class="Spotify"] move to workspace $workspace10
for_window [class="^Chromium$" title="^Spotify| - Spotify$"] move to workspace $workspace10

### make programs floating ###

# pop-up windows are always floating
#for_window [window_role="pop-up"] floating enable
# popup windows by distraction-free chrome extension
for_window [title="^StayFocusd$"] floating enable
# org-capture frame
for_window [class="Emacs" title="Org-Capture"] floating enable sticky toggle
# Bubble windows (chrome notifications) are always floating
for_window [window_role="bubble"] floating enable
# file manager
for_window [class="^Nautilus$"] floating enable
for_window [class="^Chromium$" title="^Toggl"] move to scratchpad

### borders ###

# Mendeley splash screen
for_window [class="Mendeley Desktop" instance="mendeleydesktop.x86_64" title="mendeleydesktop.x86_64"] border none
for_window [class="^Chromium$" title="^Spotify| - Spotify$"] border none
for_window [class="^Zathura$"] border none
for_window [class="^VirtualBox$" title="^Win10"] border none
# emacs
for_window [class="^Emacs$"] border 1pixel
# terminal
for_window [class="URxvt"] border 1pixel 
# chromium 
for_window [class="^Chromium$" window_role="browser"] border 1pixel

### Specific software launching keybindings ###

bindsym $mod+c exec chromium 
bindsym $mod+x exec nautilus 
bindsym $mod+m exec emacsclient -c 
bindsym $mod+d exec chromium --app=https://calendar.google.com    

# org-capture from anywhere, escape with q
bindsym $mod+z exec emacsclient -d $DISPLAY -e '(my-org-capture-other-frame)'

# Take a screenshot with scrot
bindsym Print exec scrot -b ~/Pictures/Screenshots/%Y-%m-%d-%T.png 
bindsym --release Shift+Print exec scrot -s ~/Pictures/Screenshots/%Y-%m-%d-%T-region.png 

#=======================================================================
#                            Startup software
#=======================================================================

# screenlayout created w/ arandr
exec_always --no-startup-id ~/.screenlayout/atUU.sh 

# backgrounds for two monitors
exec_always --no-startup-id nitrogen --restore 

exec --no-startup-id pulseaudio --start  # audio
exec_always --no-startup-id xbindkeys    # alternative keyboard layout
exec --no-startup-id volnoti             # volume change notification
exec --no-startup-id cbatticon           # battery indicator
exec --no-startup-id compton -cbfD 5     # composite manager
exec --no-startup-id nm-applet           # NetworkManager applet
exec --no-startup-id dropbox		 # personal file sync
exec --no-startup-id nextcloud           # uni file sync
exec --no-startup-id caffeine            # don't sleep when playing youtube
# exec --no-startup-id chromium --app=https://toggl.com/app/timer  # timetracker
exec --no-startup-id chromium --app=https://play.spotify.com     # music player
exec --no-startup-id chromium --app=https://solismail.uu.nl/owa  # uu mail

# app launcher, launch w/ Control-space
# exec --no-startup-id synapse
exec --no-startup-id gnome-pie

# f.lux or redshift reduces eye strain at night
#exec --no-startup-id xflux -l 52.1 -g 5.12 
# default is 3000-4000 during night, 5500-6500 during the day.
# Netherlands
exec --no-startup-id redshift-gtk -l 52.1:5.12 -m randr -t 5500:2500
# Hawai'i
# exec --no-startup-id redshift-gtk -l 21.3:-157.8211567 -m randr -t 5500:2500

# activity tracker
exec --no-startup-id rescuetime

#=======================================================================
#                             Mouse integration
#=======================================================================

# Hide the mouse when it's not moving
exec --no-startup-id unclutter

# Mod + rmb over titlebar toggles floating mode
bindsym $mod+button3 floating toggle

# The middle button over a titlebar kills the window 
bindsym --release button2 kill

# Mouse hovering shouldn't dictate mouse focus
focus_follows_mouse no 
